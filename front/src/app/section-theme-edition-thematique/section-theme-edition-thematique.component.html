<!-- Formulaires pour les thématiques -->

<div class="bloc_module_edition_choix" *ngIf="typeObjet==='thematique'">
  <p>Quel type de modification souhaitez-vous ?</p>
  <input type="radio" value="create" name="type_modification"
         (change)="setTypeModification('create')"/>Créer une nouvelle thematique<br />
  <input type="radio" value="update" name="type_modification"
         (change)="setTypeModification('update')"/>Modifier une thematique existante<br />
  <input type="radio" value="delete" name="type_modification"
         (change)="setTypeModification('delete')"/>Supprimer une thematique existante<br />
</div>

<!-- création thématique -->
<div *ngIf="typeModification == 'create' && typeObjet==='thematique'"
     class="bloc_module_edition_saisie">
  <form (ngSubmit)="createThematique(f)" #f="ngForm">
    <p>Quel niveau de thématique souhaitez-vous créer ?</p>
    <input type="radio" value="1" name="niveau_thematique_create"
           (change)="setNiveauThematiqueCreate(1)" ngModel/>un thème<br />
    <input type="radio" value="2" name="niveau_thematique_create"
           (change)="setNiveauThematiqueCreate(2)" ngModel/>un sous-thème<br />
    <input type="radio" value="3" name="niveau_thematique_create"
           (change)="setNiveauThematiqueCreate(3)" ngModel/>un sous sous-thème<br />

    <p *ngIf="niveauThematiqueCreate === 2 || niveauThematiqueCreate === 3">
      <em>Sélectionnez : </em><br /><br />
      <label for="theme">nom du thème : </label>
      <select id="theme" name="theme" (ngModelChange)="setThematiqueNiveau1($event)" ngModel required>
        <ng-container *ngFor="let thematique of allThematiques">
          <option [ngValue]="thematique.id"
                  *ngIf="thematique.niveau === 1">{{ thematique.nom}}</option>
        </ng-container>
      </select>
      <br />
    </p>
    <p *ngIf="niveauThematiqueCreate === 3">
      <label for="sous_theme">nom du sous-thème : </label>
      <select name="sous_theme" id="sous_theme" (ngModelChange)="setThematiqueNiveau2($event)" ngModel required>
        <option [ngValue]="thematique.id"
                *ngFor="let thematique of thematiquesNiveau2">{{ thematique.nom }}</option>
      </select><br />
    </p>
    <!--
    <p *ngIf="niveauThematiqueCreate === 4">
      <label for="sous_sous_theme">nom du sous sous-thème : </label>
      <select name="sous_sous_theme" id="sous_sous_theme">
        <option value="thematique.id"
                *ngFor="let thematique of thematiquesNiveau3">{{ thematique.nom }}</option>
      </select><br />
    </p>
    -->
    <p *ngIf="niveauThematiqueCreate === 1 || niveauThematiqueCreate === 2 || niveauThematiqueCreate === 3">
      <label for="nom">nom court : </label>
      <input type="text" id="nom" name="nom" ngModel required>
      <label for="description"> description : </label>
      <input type="text" id="description" name="description" ngModel required>
    </p>
    <p *ngIf="niveauThematiqueCreate === 1">
      <label for="image">Image thématique :</label>
      <input type="file" name="image" id="image" accept="image/png, image/jpeg">
    </p>
    <button class="bouton_bleu" type="submit" [disabled]="f.invalid"
            *ngIf="niveauThematiqueCreate === 1
              || niveauThematiqueCreate === 2
              || niveauThematiqueCreate === 3">Créer thématique</button>
  </form>
</div>

<!-- modifier une thématique -->
<div *ngIf="typeModification == 'update' && typeObjet==='thematique'"
     class="bloc_module_edition_saisie">
  <form (ngSubmit)="updateThematique(f)" #f="ngForm">
    <p>Quelle thématique souhaitez-vous modifier ?</p>
    <p>
      <label for="thematiqueUpdate">niveau & nom de la thématique à modifier: </label>
      <select id="thematiqueUpdate" name="thematiqueUpdate"
              (ngModelChange)="setUpdateThematique($event)"
              ngModel required>
        <ng-container *ngFor="let thematique of allThematiques">
          <option [ngValue]="thematique">N{{ thematique.niveau }} - {{ thematique.nom}}</option>
        </ng-container>
      </select>
      <br />
    </p>
    <p *ngIf="indicateurUpdate === true">
      <span *ngIf="(thematiqueUpdate.niveau === 2
                  || thematiqueUpdate.niveau === 3)
                  && indicateurModifierThemeParent != true">
          nom du thème parent : {{ thematiqueUpdateN1.nom }}<br /><br /></span>
      <span *ngIf="(thematiqueUpdate.niveau === 2
                    || thematiqueUpdate.niveau === 3)
                    && indicateurModifierThemeParent === true">
        <label for="theme_parent">nom du thème parent: </label>
        <select
                id="theme_parent" name="theme_parent"
                (ngModelChange)="setThematiqueNiveau1($event)" ngModel>
          <ng-container *ngFor="let thematique of allThematiques">
            <option [ngValue]="thematique.id"
                    *ngIf="thematique.niveau === 1">{{ thematique.nom}}</option>
          </ng-container>
        </select><br /><br />
      </span>

      <span *ngIf="thematiqueUpdate.niveau === 3 && indicateurModifierThemeParent != true">
          nom du sous-thème parent : {{ thematiqueUpdateN2.nom }}<br /><br /></span>
      <span *ngIf="thematiqueUpdate.niveau === 3 && indicateurModifierThemeParent === true">
        <label for="sous_theme_parent">nom du sous-thème : </label>
        <select name="sous_theme_parent" id="sous_theme_parent"
                (ngModelChange)="setThematiqueNiveau2($event)" ngModel>
          <option [ngValue]="thematique.id"
                  *ngFor="let thematique of thematiquesNiveau2">{{ thematique.nom }}</option>
        </select><br /><br />
      </span>

      <span *ngIf="thematiqueUpdate.niveau === 3 && indicateurModifierThemeParent != true">
        Souhaitez-vous modifier le thème ou le sous-thème parent ? <em> (le niveau ne peut pas être modifié)</em>
        <button class="bouton_vert" (click)="setModifierThemeParent(true)">oui</button><br /><br />
      </span>
      <span *ngIf="thematiqueUpdate.niveau === 2 && indicateurModifierThemeParent != true">
        Souhaitez-vous modifier le thème parent ? <em> (le niveau ne peut pas être modifié)</em>
        <button class="bouton_vert" (click)="setModifierThemeParent(true)">oui</button><br /><br />
      </span>
      <span *ngIf="thematiqueUpdate.niveau === 2 && indicateurModifierThemeParent === true">
        <button class="bouton_rouge" (click)="setModifierThemeParent(false)">ne plus modifier le thème parent</button><br /><br />
      </span>

      <label for="nomUpdate">nom court : </label>
      <input type="text" id="nomUpdate" name="nom"
             ngModel="{{ thematiqueUpdate.nom }}" required>
      <label for="descriptionUpdate"> description : </label>
      <input type="text" id="descriptionUpdate" name="description"
             ngModel="{{ thematiqueUpdate.description }}" required>
    </p>
    <button  class="bouton_bleu" type="submit" [disabled]="f.invalid">Modifier thématique</button>
  </form>
</div>

<!-- suppression thématique -->
<div *ngIf="typeModification == 'delete' && typeObjet==='thematique'"
     class="bloc_module_edition_saisie">
  <form (ngSubmit)="deleteThematique(f)" #f="ngForm">
    <p>Quelle thématique souhaitez-vous supprimer ?</p>
    <p>
      <label for="thematiqueDelete">niveau & nom de la thématique : </label>
      <select id="thematiqueDelete" name="thematiqueDelete" ngModel required>
        <ng-container *ngFor="let thematique of allThematiques">
          <option [ngValue]="thematique">N{{ thematique.niveau }} - {{ thematique.nom}}</option>
        </ng-container>
      </select>
      <br />
    </p>
    <button class="bouton_bleu" type="submit" [disabled]="f.invalid">Supprimer thématique</button>
  </form>
</div>
